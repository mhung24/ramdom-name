<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>B·∫£ng D·ªØ Li·ªáu Ng·∫´u Nhi√™n N√¢ng Cao</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #f4f7f6;
      }
      h1 {
        text-align: center;
        color: #2c3e50;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        background-color: white;
        font-size: 0.9em;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
      }
      th {
        background-color: #3498db;
        color: white;
      }
      tr:nth-child(even) {
        background-color: #f9f9f9;
      }
      .delete-btn {
        background-color: #e74c3c;
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
        border-radius: 4px;
        transition: background-color 0.3s;
      }
      .delete-btn:hover {
        background-color: #c0392b;
      }
      .control-btns {
        text-align: center;
        margin-bottom: 20px;
      }
      .control-btns button {
        padding: 10px 20px;
        font-size: 1em;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        margin: 0 5px;
        transition: background-color 0.3s;
      }
      #regenerateBtn {
        background-color: #2ecc71;
        color: white;
      }
      #regenerateBtn:hover {
        background-color: #27ae60;
      }
      #deleteAllBtn {
        background-color: #f39c12;
        color: white;
      }
      #deleteAllBtn:hover {
        background-color: #e67e22;
      }
      .copy-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .copy-icon {
        cursor: pointer;
        margin-left: 8px;
        font-size: 1.1em;
        color: #3498db;
      }
      .copy-icon:hover {
        color: #2980b9;
      }
    </style>
  </head>
  <body>
    <h1>Danh S√°ch Ng·∫´u Nhi√™n (100 D√≤ng - H·ªç v√† T√™n Duy Nh·∫•t)</h1>

    <div class="control-btns">
      <button id="regenerateBtn" onclick="regenerateData()">
        T·∫°o l·∫°i 100 D·ªØ li·ªáu M·ªõi
      </button>
      <button id="deleteAllBtn" onclick="deleteAllData()">
        X√≥a To√†n B·ªô D·ªØ Li·ªáu B·∫£ng & LocalStorage
      </button>
    </div>

    <table id="dataTable">
      <thead>
        <tr>
          <th>STT</th>
          <th>T√™n Ri√™ng (First Name)</th>
          <th>H·ªç (Last Name)</th>
          <th>S·ªë ƒêi·ªán Tho·∫°i</th>
          <th>Thao T√°c</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      const LOCAL_STORAGE_KEY = "randomDataList";

      function getRandomElement(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      function generateMeaningfulRandomName(existingLastNames) {
        const prefixes = [
          "Al",
          "El",
          "Mar",
          "Cor",
          "Don",
          "Ea",
          "Bri",
          "Ja",
          "Mi",
          "Ly",
          "Ro",
          "Sam",
          "Ken",
          "Dav",
          "Jes",
          "Chri",
          "Tho",
          "Nic",
          "Pat",
          "Ste",
          "Vic",
          "Zer",
          "Fox",
          "Sil",
        ];
        const middles = [
          "vin",
          "der",
          "lan",
          "tha",
          "lie",
          "dan",
          "son",
          "lia",
          "cus",
          "lor",
          "dric",
          "mond",
          "tin",
          "per",
          "ford",
          "gar",
          "well",
          "ry",
          "mont",
          "ton",
          "field",
          "ham",
          "sen",
        ];
        const suffixes = [
          "a",
          "o",
          "us",
          "er",
          "et",
          "ley",
          "ton",
          "y",
          "am",
          "an",
          "el",
          "es",
          "ing",
          "on",
          "den",
          "ski",
          "ich",
          "man",
          "son",
          "ter",
          "ler",
          "kin",
          "lin",
        ];

        let lastName;
        do {
          if (Math.random() < 0.5) {
            lastName =
              getRandomElement(prefixes) +
              getRandomElement(middles) +
              getRandomElement(suffixes);
          } else {
            lastName = getRandomElement(prefixes) + getRandomElement(suffixes);
          }
          lastName = lastName.charAt(0).toUpperCase() + lastName.slice(1);
        } while (existingLastNames && existingLastNames.has(lastName));

        let firstName =
          getRandomElement(prefixes) +
          getRandomElement(middles) +
          getRandomElement(suffixes);

        firstName = firstName.charAt(0).toUpperCase() + firstName.slice(1);

        return {
          firstName: firstName,
          lastName: lastName,
          fullName: `${firstName} ${lastName}`,
        };
      }

      const getRandomNumber = (min, max) =>
        Math.floor(Math.random() * (max - min + 1)) + min;

      function generateRandomPhoneNumberUS() {
        const areaCode = `${getRandomNumber(2, 9)}${getRandomNumber(
          0,
          9
        )}${getRandomNumber(0, 9)}`;
        const prefix = `${getRandomNumber(0, 9)}${getRandomNumber(
          0,
          9
        )}${getRandomNumber(0, 9)}`;
        let lineNumber = "";
        for (let i = 0; i < 4; i++) {
          lineNumber += getRandomNumber(0, 9);
        }
        return `(${areaCode}) ${prefix}-${lineNumber}`;
      }

      function createNewDataList(count = 100) {
        const dataList = [];
        const fullNameSet = new Set();
        const lastNameSet = new Set();

        for (let i = 0; i < count; i++) {
          let nameParts;
          let isUnique = false;

          do {
            nameParts = generateMeaningfulRandomName(lastNameSet);

            if (!fullNameSet.has(nameParts.fullName)) {
              isUnique = true;
            }
          } while (!isUnique);

          fullNameSet.add(nameParts.fullName);
          lastNameSet.add(nameParts.lastName);

          dataList.push({
            id: Date.now() + i,
            initialIndex: i + 1,
            firstName: nameParts.firstName,
            lastName: nameParts.lastName,
            phone: generateRandomPhoneNumberUS(),
          });
        }
        saveData(dataList);
        return dataList;
      }

      function saveData(data) {
        localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(data));
      }

      function loadData() {
        const storedData = localStorage.getItem(LOCAL_STORAGE_KEY);
        const data = storedData ? JSON.parse(storedData) : null;
        if (
          data &&
          data.length > 0 &&
          !data[0].hasOwnProperty("initialIndex")
        ) {
          data.forEach((item, index) => {
            item.initialIndex = index + 1;
          });
          saveData(data);
        }
        return data;
      }

      function deleteRow(rowId) {
        let dataList = loadData();
        if (!dataList) return;

        dataList = dataList.filter((item) => item.id !== rowId);

        saveData(dataList);

        renderTable(dataList);
      }

      function deleteAllData() {
        if (
          confirm(
            "C·∫¢NH B√ÅO: B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën X√ìA TO√ÄN B·ªò d·ªØ li·ªáu kh·ªèi LocalStorage v√† b·∫£ng hi·ªán t·∫°i kh√¥ng?"
          )
        ) {
          localStorage.removeItem(LOCAL_STORAGE_KEY);
          alert(
            "To√†n b·ªô d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c x√≥a. B·∫£ng s·∫Ω ƒë∆∞·ª£c t·∫£i l·∫°i v·ªõi d·ªØ li·ªáu m·ªõi."
          );
          loadAndRenderData();
        }
      }

      function regenerateData() {
        if (
          confirm(
            "B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën T·∫†O L·∫†I 100 d·ªØ li·ªáu m·ªõi kh√¥ng? D·ªØ li·ªáu c≈© s·∫Ω b·ªã x√≥a."
          )
        ) {
          const newData = createNewDataList(100);
          renderTable(newData);
        }
      }

      function copyToClipboard(text, element) {
        navigator.clipboard.writeText(text).then(
          () => {
            const originalContent = element.innerHTML;
            element.innerHTML = "‚úÖ";
            element.style.color = "#2ecc71";

            setTimeout(() => {
              element.innerHTML = originalContent;
              element.style.color = "#3498db";
            }, 1000);
          },
          (err) => {
            console.error("Could not copy text: ", err);
            alert("Kh√¥ng th·ªÉ sao ch√©p. Vui l√≤ng th·ª≠ l·∫°i.");
          }
        );
      }

      function renderTable(dataList) {
        const tableBody = document.querySelector("#dataTable tbody");
        tableBody.innerHTML = "";

        dataList.forEach((item) => {
          const row = tableBody.insertRow();

          const cellStt = row.insertCell();
          cellStt.textContent = item.initialIndex || "";

          const cellFirstName = row.insertCell();
          cellFirstName.innerHTML = `
                    <div class="copy-container">
                        <span>${item.firstName}</span>
                        <span class="copy-icon" onclick="copyToClipboard('${item.firstName}', this)">üìã</span>
                    </div>
                `;

          const cellLastName = row.insertCell();
          cellLastName.innerHTML = `
                    <div class="copy-container">
                        <span>${item.lastName}</span>
                        <span class="copy-icon" onclick="copyToClipboard('${item.lastName}', this)">üìã</span>
                    </div>
                `;

          const cellPhone = row.insertCell();
          cellPhone.innerHTML = `
                    <div class="copy-container">
                        <span>${item.phone}</span>
                        <span class="copy-icon" onclick="copyToClipboard('${item.phone}', this)">üìã</span>
                    </div>
                `;

          const cellAction = row.insertCell();
          const deleteButton = document.createElement("button");
          deleteButton.className = "delete-btn";
          deleteButton.textContent = "X√≥a";
          deleteButton.onclick = function () {
            deleteRow(item.id);
          };
          cellAction.appendChild(deleteButton);
        });
      }

      function loadAndRenderData() {
        let dataList = loadData();

        if (!dataList || dataList.length === 0) {
          dataList = createNewDataList(100);
        }

        renderTable(dataList);
      }

      window.onload = loadAndRenderData;
    </script>
  </body>
</html>
