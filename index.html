<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Bảng 100 Tên và SĐT Ngẫu Nhiên</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #f4f7f6;
      }
      h1 {
        text-align: center;
        color: #2c3e50;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        background-color: white;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 12px;
        text-align: left;
      }
      th {
        background-color: #3498db;
        color: white;
      }
      tr:nth-child(even) {
        background-color: #f9f9f9;
      }
      .delete-btn {
        background-color: #e74c3c;
        color: white;
        border: none;
        padding: 8px 12px;
        cursor: pointer;
        border-radius: 4px;
        font-weight: bold;
        transition: background-color 0.3s;
      }
      .delete-btn:hover {
        background-color: #c0392b;
      }
      .control-btns {
        text-align: center;
        margin-bottom: 20px;
      }
      .control-btns button {
        padding: 10px 20px;
        font-size: 1em;
        cursor: pointer;
        border: none;
        border-radius: 5px;
        margin: 0 5px;
        transition: background-color 0.3s;
      }
      #regenerateBtn {
        background-color: #2ecc71;
        color: white;
      }
      #regenerateBtn:hover {
        background-color: #27ae60;
      }
      #deleteAllBtn {
        background-color: #f39c12;
        color: white;
      }
      #deleteAllBtn:hover {
        background-color: #e67e22;
      }
    </style>
  </head>
  <body>
    <h1>Danh Sách Ngẫu Nhiên</h1>

    <div class="control-btns">
      <button id="regenerateBtn" onclick="regenerateData()">
        Tạo lại 100 Dữ liệu Mới
      </button>
      <button id="deleteAllBtn" onclick="deleteAllData()">
        Xóa Toàn Bộ Dữ Liệu Bảng & LocalStorage
      </button>
    </div>

    <table id="dataTable">
      <thead>
        <tr>
          <th>STT</th>
          <th>Tên Đầy Đủ</th>
          <th>Số Điện Thoại</th>
          <th>Thao Tác</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script>
      const LOCAL_STORAGE_KEY = "randomDataList";

      function getRandomElement(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      function generateMeaningfulRandomName() {
        const prefixes = [
          "Al",
          "El",
          "Mar",
          "Cor",
          "Don",
          "Ea",
          "Bri",
          "Ja",
          "Mi",
          "Ly",
        ];
        const middles = [
          "vin",
          "der",
          "lan",
          "tha",
          "lie",
          "dan",
          "son",
          "lia",
          "cus",
          "lor",
        ];
        const suffixes = [
          "a",
          "o",
          "us",
          "er",
          "et",
          "ley",
          "ton",
          "y",
          "am",
          "an",
        ];
        const lastNames = [
          "Taylor",
          "Smith",
          "Wilson",
          "Johnson",
          "Brown",
          "Clark",
          "Moore",
          "King",
        ];

        let firstName =
          getRandomElement(prefixes) +
          getRandomElement(middles) +
          getRandomElement(suffixes);
        firstName = firstName.charAt(0).toUpperCase() + firstName.slice(1);
        const lastName = getRandomElement(lastNames);

        return `${firstName} ${lastName}`;
      }

      const getRandomNumber = (min, max) =>
        Math.floor(Math.random() * (max - min + 1)) + min;

      function generateRandomPhoneNumberUS() {
        const areaCode = `${getRandomNumber(2, 9)}${getRandomNumber(
          0,
          9
        )}${getRandomNumber(0, 9)}`;
        const prefix = `${getRandomNumber(0, 9)}${getRandomNumber(
          0,
          9
        )}${getRandomNumber(0, 9)}`;
        let lineNumber = "";
        for (let i = 0; i < 4; i++) {
          lineNumber += getRandomNumber(0, 9);
        }
        return `(${areaCode}) ${prefix}-${lineNumber}`;
      }

      function createNewDataList(count = 100) {
        const dataList = [];
        for (let i = 0; i < count; i++) {
          dataList.push({
            id: Date.now() + i,
            name: generateMeaningfulRandomName(),
            phone: generateRandomPhoneNumberUS(),
          });
        }
        saveData(dataList);
        return dataList;
      }

      function saveData(data) {
        localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(data));
      }

      function loadData() {
        const storedData = localStorage.getItem(LOCAL_STORAGE_KEY);
        return storedData ? JSON.parse(storedData) : null;
      }

      function deleteRow(rowId) {
        let dataList = loadData();
        if (!dataList) return;

        dataList = dataList.filter((item) => item.id !== rowId);

        saveData(dataList);

        renderTable(dataList);
      }

      function deleteAllData() {
        if (
          confirm(
            "CẢNH BÁO: Bạn có chắc chắn muốn XÓA TOÀN BỘ dữ liệu khỏi LocalStorage và bảng hiện tại không?"
          )
        ) {
          localStorage.removeItem(LOCAL_STORAGE_KEY);
          alert(
            "Toàn bộ dữ liệu đã được xóa. Bảng sẽ được tải lại với dữ liệu mới."
          );
          loadAndRenderData();
        }
      }

      function regenerateData() {
        if (
          confirm(
            "Bạn có chắc chắn muốn TẠO LẠI 100 dữ liệu mới không? Dữ liệu cũ sẽ bị xóa."
          )
        ) {
          const newData = createNewDataList(100);
          renderTable(newData);
        }
      }

      function renderTable(dataList) {
        const tableBody = document.querySelector("#dataTable tbody");
        tableBody.innerHTML = "";

        dataList.forEach((item, index) => {
          const row = tableBody.insertRow();

          const cellStt = row.insertCell();
          cellStt.textContent = index + 1;

          const cellName = row.insertCell();
          cellName.textContent = item.name;

          const cellPhone = row.insertCell();
          cellPhone.textContent = item.phone;

          const cellAction = row.insertCell();
          const deleteButton = document.createElement("button");
          deleteButton.className = "delete-btn";
          deleteButton.textContent = "Xóa";
          deleteButton.onclick = function () {
            if (
              confirm(`Bạn có chắc chắn muốn xóa dòng "${item.name}" không?`)
            ) {
              deleteRow(item.id);
            }
          };
          cellAction.appendChild(deleteButton);
        });
      }

      function loadAndRenderData() {
        let dataList = loadData();

        if (!dataList || dataList.length === 0) {
          dataList = createNewDataList(100);
        }

        renderTable(dataList);
      }

      window.onload = loadAndRenderData;
    </script>
  </body>
</html>
